<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-connector/Kafka-Connector">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Apache Kafka Connector | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org//zh-CN/docs/connector/Kafka-Connector"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Apache Kafka Connector | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="Flink 官方提供了Apache Kafka的连接器,用于从 Kafka topic 中读取或者向其中写入数据,可提供 精确一次 的处理语义"><meta data-rh="true" property="og:description" content="Flink 官方提供了Apache Kafka的连接器,用于从 Kafka topic 中读取或者向其中写入数据,可提供 精确一次 的处理语义"><link data-rh="true" rel="icon" href="/zh-CN/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org//zh-CN/docs/connector/Kafka-Connector"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//docs/connector/Kafka-Connector" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//zh-CN/docs/connector/Kafka-Connector" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//docs/connector/Kafka-Connector" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/zh-CN/assets/css/styles.edc24a23.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.bc03e73f.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.e2f9a7ff.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apache StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-CN/">首页</a><a href="https://github.com/apache/incubator-streampark/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">下载</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/intro">文档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">社区</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of conduct</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/mailing_lists">Join the mailing lists</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_committer">Become A Committer</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_pmc_member">Become A PMC member</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_committer_process">New Committer Process</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_pmc_ember_process">New PMC Member Process</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/document">Documentation Notice</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/submit_code">Submit Code</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/team">团队</a><a class="navbar__item navbar__link" href="/zh-CN/user">用户</a><a class="navbar__item navbar__link" href="/zh-CN/blog">博客</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">基金会</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">证书</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">事件</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">安全</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">致谢</a></li></ul></div><a href="https://github.com/apache/incubator-streampark" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/connector/Kafka-Connector" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-CN/docs/connector/Kafka-Connector" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">简体中文</a></li></ul></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/intro">框架介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/user-guide/deployment">User guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/deployment">平台部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/quick-start">快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/development">开发环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/docker-deployment">Docker 快速使用教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/LDAP">LDAP 快速使用教程</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/development/dev-model">Development framework</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/dev-model">编程模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/config">项目配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/alert-conf">报警配置</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/docs/connector/Kafka-Connector">DataStream Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/connector/Kafka-Connector">Apache Kafka Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Jdbc-Connector">JDBC Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Clickhouse-Connector">Clickhouse Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Doris-Connector">Apache Doris Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Elasticsearch-Connector">Elasticsearch Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Hbase-Connector">Apache HBase Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Http-Connector">Http Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Redis-Connector">Redis Connector</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/flinksql/1-query-config">Flink Sql</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/1-query-config">查询配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/2-performance-tuning">性能调整</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/3-read-write-hive">读写hive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/4-data-type">数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/5-example">使用案例</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/syntax/1-introduce">Syntax</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/2-set">set</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/3-reset">reset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/4-create">create</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/5-insert">insert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/6-use">use</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/7-select">select</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/8-describe">describe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/9-alter">alter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/10-explain">explain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/11-drop">drop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/12-load">load</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/13-unload">unload</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/14-show">show</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/udf/1-introduce">Functions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/udf/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/udf/2-udf">自定义函数</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/format/1-introduce">Format</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/2-csv">CSV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/3-json">JSON</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/4-avro">AVRO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/5-confluent-avro">Confluent Avro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/6-debezium">Debezium</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/7-canal">Canal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/8-maxwell">Maxwell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/9-ogg">Ogg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/10-parquet">Parquet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/11-orc">Orc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/12-raw">Raw</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/connector/1-introduce">Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/2-kafka">Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/3-upsert-kafka">Upsert Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/4-jdbc">JDBC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/5-elasticsearch">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/6-file-system">FileSystem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/7-hbase">Hbase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/8-data-gen">DataGen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/9-print">Print</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/10-black-hole">BlackHole</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/advanced/">Advanced extensions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/flink-k8s/k8s-dev">Deployment</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/k8s-dev">Flink K8s 集成支持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/k8s-pvc-integration">K8S PVC 资源使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/hadoop-resource-integration">Hadoop 资源集成</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">DataStream Connector</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Apache Kafka Connector</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Apache Kafka Connector</h1></header><p><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html" target="_blank" rel="noopener noreferrer">Flink 官方</a>提供了<a href="http://kafka.apache.org" target="_blank" rel="noopener noreferrer">Apache Kafka</a>的连接器,用于从 Kafka topic 中读取或者向其中写入数据,可提供 <strong>精确一次</strong> 的处理语义</p><p><code>StreamPark</code>中<code>KafkaSource</code>和<code>KafkaSink</code>基于官网的<code>kafka connector</code>进一步封装,屏蔽很多细节,简化开发步骤,让数据的读取和写入更简单</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="依赖">依赖<a class="hash-link" href="#依赖" title="标题的直接链接">​</a></h2><p><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html" target="_blank" rel="noopener noreferrer">Apache Flink</a> 集成了通用的 Kafka 连接器，它会尽力与 Kafka client 的最新版本保持同步。该连接器使用的 Kafka client 版本可能会在 Flink 版本之间发生变化。 当前 Kafka client 向后兼容 0.10.0 或更高版本的 Kafka broker。 有关 Kafka 兼容性的更多细节，请参考 <a href="https://kafka.apache.org/protocol.html#protocol_compatibility" target="_blank" rel="noopener noreferrer">Kafka</a> 官方文档。</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&lt;!--必须要导入的依赖--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.apache.streampark</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">streampark-flink-core</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&lt;!--flink-connector--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">flink-connector-kafka_2.11</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">1.12.0</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>同时在开发阶段,以下的依赖也是必要的</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&lt;!--以下scope为provided的依赖也是必须要导入的--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">flink-scala_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">flink-clients_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">flink-streaming-scala_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">scope</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-source-consumer">Kafka Source (Consumer)<a class="hash-link" href="#kafka-source-consumer" title="标题的直接链接">​</a></h2><p>先介绍基于官网的标准的kafka consumer的方式,以下代码摘自 <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html#kafka-consumer" target="_blank" rel="noopener noreferrer">Apache Kafka 官网文档</a></p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">val properties = new Properties()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">properties.setProperty(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">properties.setProperty(&quot;group.id&quot;, &quot;test&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">val stream = env.addSource(new FlinkKafkaConsumer[String](&quot;topic&quot;, new SimpleStringSchema(), properties))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以看到一上来定义了一堆kafka的连接信息,这种方式各项参数都是硬编码的方式写死的,非常的不灵敏,下面我们来看看如何用<code>StreamPark</code>接入 <code>kafka</code>的数据,只需要按照规定的格式定义好配置文件然后编写代码即可,配置和代码如下</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基础消费示例">基础消费示例<a class="hash-link" href="#基础消费示例" title="标题的直接链接">​</a></h3><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> test_user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意事项</div><div class="admonitionContent_S0QG"><p><code>kafka.source</code>这个前缀是固定的,kafka properties相关的参数必须遵守 <a href="http://kafka.apache.org" target="_blank" rel="noopener noreferrer">Apache Kafka 官网文档</a> 对参数key的设置规范</p></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">package org.apache.streampark.flink.quickstart</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">object kafkaSourceApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        val source = KafkaSource().getDataStream[String]()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print(source)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">public class KafkaSimpleJavaApp {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        source.print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="高级配置参数">高级配置参数<a class="hash-link" href="#高级配置参数" title="标题的直接链接">​</a></h3><p><code>KafkaSource</code>是基于Flink Kafka Connector封装一个更简单的kafka读取类,构造方法里需要传入<code>StreamingContext</code>,当程序启动时传入配置文件即可,框架会自动解析配置文件,在<code>new KafkaSource</code>的时候会自动的从配置文件中获取相关信息,初始化并返回一个Kafka Consumer,在这里topic下只配置了一个topic,因此在消费的时候不用指定topic直接默认获取这个topic来消费, 这只是一个最简单的例子,更多更复杂的规则和读取操作则要通过<code>.getDataStream()</code>在该方法里传入参数才能实现
我们看看<code>getDataStream</code>这个方法的签名</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">def getDataStream[T: TypeInformation](topic: java.io.Serializable = null,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    alias: String = &quot;&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    deserializer: KafkaDeserializationSchema[T],</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    strategy: WatermarkStrategy[KafkaRecord[T]] = null</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">): DataStream[KafkaRecord[T]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>参数具体作用如下</p><table><thead><tr><th align="left">参数名</th><th align="left">参数类型</th><th align="left">作用</th><th align="left">默认值</th></tr></thead><tbody><tr><td align="left"><code>topic</code></td><td align="left">Serializable</td><td align="left">一个topic或者一组topic</td><td align="left">无</td></tr><tr><td align="left"><code>alias</code></td><td align="left">String</td><td align="left">用于区别不同的kafka实例</td><td align="left">无</td></tr><tr><td align="left"><code>deserializer</code></td><td align="left">DeserializationSchema</td><td align="left">topic里数据的具体解析类</td><td align="left">KafkaStringDeserializationSchema</td></tr><tr><td align="left"><code>strategy</code></td><td align="left">WatermarkStrategy</td><td align="left">watermark生成策略</td><td align="left">无</td></tr></tbody></table><p>下面我们来看看更多的使用和配置方式</p><div class="counter"><ul><li>消费多个Kafka实例</li><li>消费多个Topic</li><li>Topic动态发现</li><li>从指定Offset消费</li><li>指定KafkaDeserializationSchema</li><li>指定WatermarkStrategy</li></ul></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费多个kafka实例">消费多个Kafka实例<a class="hash-link" href="#消费多个kafka实例" title="标题的直接链接">​</a></h3><p>在框架开发之初就考虑到了多个不同实例的kafka的配置情况.如何来统一配置,并且规范格式呢?在streampark中是这么解决的,假如我们要同时消费两个不同实例的kafka,配置文件定义如下,
可以看到在 <code>kafka.source</code> 下直接放kafka的实例名称(名字可以任意),在这里我们统一称为 <strong>alias</strong> , <strong>alias</strong> 必须是唯一的,来区别不同的实例,然后别的参数还是按照之前的规范,
统统放到当前这个实例的 <code>namespace</code> 下即可.如果只有一个kafka实例,则可以不用配置 <code>alias</code>
在写代码消费时注意指定对应的 <strong>alias</strong> 即可,配置和代码如下</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">配置</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">kafka1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> test_user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">kafka2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kafka2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kafka2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//消费kafka1实例的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KafkaSource().getDataStream[String](alias = &quot;kafka1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费kafka2实例的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KafkaSource().getDataStream[String](alias = &quot;kafka2&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .uid(&quot;kfkSource2&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .name(&quot;kfkSource2&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费kafka1实例的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .alias(&quot;kafka1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费kafka1实例的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DataStream&lt;String&gt; source2 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .alias(&quot;kafka2&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context.start();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>特别注意</div><div class="admonitionContent_S0QG"><p>java api在编写代码时,一定要将<code>alias</code>等这些参数的设置放到调用<code>.getDataStream()</code>之前</p></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费多个topic">消费多个Topic<a class="hash-link" href="#消费多个topic" title="标题的直接链接">​</a></h3><p>配置消费多个topic也很简单,在配置文件<code>topic</code>下配置多个topic名称即可,用<code>,</code>或空格分隔,代码消费处理的时候指定topic参数即可,<code>scala</code> api下如果是消费一个topic,则直接传入topic名称即可,如果要消费多个,传入一个<code>List</code>即可
<code>java</code>api通过 <code>topic()</code>方法传入要消费topic的名称,是一个String类型的可变参数,可以传入一个或多个<code>topic</code>名称,配置和代码如下</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">配置</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> topic1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">topic2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">topic3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(0, 128, 0)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//消费指定单个topic的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KafkaSource().getDataStream[String](topic = &quot;topic1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费一批topic数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KafkaSource().getDataStream[String](topic = List(&quot;topic1&quot;,&quot;topic2&quot;,&quot;topic3&quot;))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//消费指定单个topic的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .topic(&quot;topic1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费一组topic的数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .topic(&quot;topic1&quot;,&quot;topic2&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_S0QG"><p><code>topic</code>支持配置多个<code>topic</code>实例,每个<code>topic</code>直接用<code>,</code>分隔或者空格分隔,如果topic下配置多个实例,在消费的时必须指定具体的topic名称</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="topic-发现">Topic 发现<a class="hash-link" href="#topic-发现" title="标题的直接链接">​</a></h3><p>关于kafka的分区动态,默认情况下，是禁用了分区发现的。若要启用它，请在提供的属性配置中为 <code>flink.partition-discovery.interval-millis</code> 设置大于 <code>0</code>,表示发现分区的间隔是以毫秒为单位的
更多详情请参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#partition-discovery" target="_blank" rel="noopener noreferrer">官网文档</a></p><p>Flink Kafka Consumer 还能够使用正则表达式基于 Topic 名称的模式匹配来发现 Topic,详情请参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#topic-discovery" target="_blank" rel="noopener noreferrer">官网文档</a>
在<code>StreamPark</code>中提供更简单的方式,具体需要在 <code>pattern</code>下配置要匹配的<code>topic</code>实例名称的正则即可</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">配置</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ^topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> user_02</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(0, 128, 0)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//消费正则topic数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KafkaSource().getDataStream[String](topic = &quot;topic-a&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.print()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//消费通配符topic数据</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .topic(&quot;topic-a&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context.start();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>特别注意</div><div class="admonitionContent_S0QG"><p><code>topic</code>和<code>pattern</code>不能同时配置,当配置了<code>pattern</code>正则匹配时,在消费的时候依然可以指定一个确定的<code>topic</code>名称,此时会检查<code>pattern</code>是否匹配当前的<code>topic</code>,如不匹配则会报错</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置开始消费的位置">配置开始消费的位置<a class="hash-link" href="#配置开始消费的位置" title="标题的直接链接">​</a></h3><p>Flink Kafka Consumer 允许通过配置来确定 Kafka 分区的起始位置,<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#kafka-consumers-start-position-configuration" target="_blank" rel="noopener noreferrer">官网文档</a>Kafka 分区的起始位置具体操作方式如下</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">val env = StreamExecutionEnvironment.getExecutionEnvironment()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">val myConsumer = new FlinkKafkaConsumer[String](...)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromEarliest()      // 尽可能从最早的记录开始</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromLatest()        // 从最新的记录开始</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromTimestamp(...)  // 从指定的时间开始（毫秒）</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromGroupOffsets()  // 默认的方法</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">val stream = env.addSource(myConsumer)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FlinkKafkaConsumer&lt;String&gt; myConsumer = new FlinkKafkaConsumer&lt;&gt;(...);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromEarliest();     // 尽可能从最早的记录开始</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromLatest();       // 从最新的记录开始</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromTimestamp(...); // 从指定的时间开始（毫秒）</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">myConsumer.setStartFromGroupOffsets(); // 默认的方法</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DataStream&lt;String&gt; stream = env.addSource(myConsumer);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>在<code>StreamPark</code>中不推荐这种方式进行设定,提供了更方便的方式,只需要在配置里指定 <code>auto.offset.reset</code> 即可</p><ul><li><code>earliest</code> 从最早的记录开始</li><li><code>latest</code> 从最新的记录开始</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定分区offset">指定分区Offset<a class="hash-link" href="#指定分区offset" title="标题的直接链接">​</a></h3><p>你也可以为每个分区指定 consumer 应该开始消费的具体 offset,只需要按照如下的配置文件配置<code>start.from</code>相关的信息即可</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> topic1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">topic2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">topic3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(0, 128, 0)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">start.from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1591286400000</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">#指定timestamp,针对所有的topic生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">offset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># 给topic的partition指定offset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> topic_abc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">topic_123</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">topic_abc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> 0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">183</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">#分区0从182开始消费,分区1从183开始,分区2从182开始...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">topic_123</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> 0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">183</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定deserializer">指定deserializer<a class="hash-link" href="#指定deserializer" title="标题的直接链接">​</a></h3><p>默认不指定<code>deserializer</code>则在内部采用String的方式反序列化topic中的数据,可以手动指定<code>deserializer</code>,这样可以一步直接返回目标<code>DataStream</code>,具体完整代码如下</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.java.typeutils.TypeExtractor.getForClass</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">object KafkaSourceApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        KafkaSource()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          .getDataStream[String](deserializer = new UserSchema)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          .map(_.value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          .print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class UserSchema extends KafkaDeserializationSchema[User] {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def isEndOfStream(nextElement: User): Boolean = false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def getProducedType: TypeInformation[User] = getForClass(classOf[User])</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def deserialize(record: ConsumerRecord[Array[Byte], Array[Byte]]): User = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    val value = new String(record.value())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    JsonUtils.read[User](value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">case class User(name:String,age:Int,gender:Int,address:String)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import static org.apache.flink.api.java.typeutils.TypeExtractor.getForClass;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">public class KafkaSourceJavaApp {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        new KafkaSource&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .deserializer(new JavaUserSchema())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;JavaUser&gt;, JavaUser&gt;) KafkaRecord::value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUserSchema implements KafkaDeserializationSchema&lt;JavaUser&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    private ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public boolean isEndOfStream(JavaUser nextElement) return false;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public TypeInformation&lt;JavaUser&gt; getProducedType() return getForClass(JavaUser.class);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public JavaUser deserialize(ConsumerRecord&lt;byte[], byte[]&gt; record) throws Exception {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        String value = new String(record.value());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        return mapper.readValue(value, JavaUser.class);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="返回记录kafkarecord">返回记录KafkaRecord<a class="hash-link" href="#返回记录kafkarecord" title="标题的直接链接">​</a></h3><p>返回的对象被包装在<code>KafkaRecord</code>中,<code>kafkaRecord</code>中有当前的<code>offset</code>,<code>partition</code>,<code>timestamp</code>等诸多有用的信息供开发者使用,其中<code>value</code>即返回的目标对象,如下图:</p><p><img loading="lazy" src="/zh-CN/assets/images/streampark_kafkaapi-c3eb75726e1ec7cb8788dea846c54933.jpeg" width="1936" height="1196" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定strategy">指定strategy<a class="hash-link" href="#指定strategy" title="标题的直接链接">​</a></h3><p>在许多场景中,记录的时间戳是(显式或隐式)嵌入到记录本身中。此外,用户可能希望定期或以不规则的方式<code>Watermark</code>,例如基于<code>Kafka</code>流中包含当前事件时间的<code>watermark</code>的特殊记录。对于这些情况，<code>Flink Kafka Consumer</code>是允许指定<code>AssignerWithPeriodicWatermarks</code>或<code>AssignerWithPunctuatedWatermarks</code></p><p>在<code>StreamPark</code>中运行传入一个<code>WatermarkStrategy</code>作为参数来分配<code>Watermark</code>,如下面的示例,解析<code>topic</code>中的数据为<code>user</code>对象,<code>user</code>中有个 <code>orderTime</code> 是时间类型,我们以这个为基准,为其分配一个<code>Watermark</code></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.{KafkaRecord, KafkaSource}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.eventtime.{SerializableTimestampAssigner, WatermarkStrategy}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.java.typeutils.TypeExtractor.getForClass</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.time.Duration</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.util.Date</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">object KafkaSourceStrategyApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    KafkaSource()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      .getDataStream[User](</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        deserializer = new UserSchema,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        strategy = WatermarkStrategy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          .forBoundedOutOfOrderness[KafkaRecord[User]](Duration.ofMinutes(1))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          .withTimestampAssigner(new SerializableTimestampAssigner[KafkaRecord[User]] {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            override def extractTimestamp(element: KafkaRecord[User], recordTimestamp: Long): Long = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              element.value.orderTime.getTime</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          })</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ).map(_.value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      .print()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class UserSchema extends KafkaDeserializationSchema[User] {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def isEndOfStream(nextElement: User): Boolean = false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def getProducedType: TypeInformation[User] = getForClass(classOf[User])</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  override def deserialize(record: ConsumerRecord[Array[Byte], Array[Byte]]): User = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    val value = new String(record.value())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    JsonUtils.read[User](value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String, orderTime: Date)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.eventtime.SerializableTimestampAssigner;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.eventtime.WatermarkStrategy;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.time.Duration;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.util.Date;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import static org.apache.flink.api.java.typeutils.TypeExtractor.getForClass;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> * @author benjobs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">public class KafkaSourceStrategyJavaApp {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        new KafkaSource&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .deserializer(new JavaUserSchema())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .strategy(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        WatermarkStrategy.&lt;KafkaRecord&lt;JavaUser&gt;&gt;forBoundedOutOfOrderness(Duration.ofMinutes(1))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                .withTimestampAssigner(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                        (SerializableTimestampAssigner&lt;KafkaRecord&lt;JavaUser&gt;&gt;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                (element, recordTimestamp) -&gt; element.value().orderTime.getTime()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;JavaUser&gt;, JavaUser&gt;) KafkaRecord::value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .print();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUserSchema implements KafkaDeserializationSchema&lt;JavaUser&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    private ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public boolean isEndOfStream(JavaUser nextElement) return false;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public TypeInformation&lt;JavaUser&gt; getProducedType() return getForClass(JavaUser.class);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    @Override public JavaUser deserialize(ConsumerRecord&lt;byte[], byte[]&gt; record) throws Exception {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        String value = new String(record.value());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        return mapper.readValue(value, JavaUser.class);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Date orderTime;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意事项</div><div class="admonitionContent_S0QG"><p>如果<code>watermark assigner</code>依赖于从<code>Kafka</code>读取的消息来上涨其<code>watermark</code>(通常就是这种情况),那么所有主题和分区都需要有连续的消息流。否则, <strong>整个应用程序的<code>watermark</code>将无法上涨</strong> ，所有基于时间的算子(例如时间窗口或带有计时器的函数)也无法运行。单个的<code>Kafka</code>分区也会导致这种反应。考虑设置适当的 <strong><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamps_watermarks.html#dealing-with-idle-sources" target="_blank" rel="noopener noreferrer"><code>idelness timeouts</code></a></strong> 来缓解这个问题。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-sink-producer">Kafka Sink (Producer)<a class="hash-link" href="#kafka-sink-producer" title="标题的直接链接">​</a></h2><p>在<code>StreamPark</code>中<code>Kafka Producer</code> 被称为<code>KafkaSink</code>,它允许将消息写入一个或多个<code>Kafka topic中</code></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> val source = KafkaSource().getDataStream[String]().map(_.value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> KafkaSink().sink(source)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> new KafkaSink&lt;String&gt;(context).sink(source);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> context.start();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><code>sink</code>是具体的写入数据的方法,参数列表如下</p><table><thead><tr><th align="left">参数名</th><th align="left">参数类型</th><th align="left">作用</th><th align="left">默认值</th><th align="left">必须</th></tr></thead><tbody><tr><td align="left"><code>stream</code></td><td align="left">DataStream<!-- -->[T]</td><td align="left">要写的数据流</td><td align="left">无</td><td align="left">yes</td></tr><tr><td align="left"><code>alias</code></td><td align="left">String</td><td align="left"><code>kafka</code>的实例别名</td><td align="left">无</td><td align="left">no</td></tr><tr><td align="left"><code>serializationSchema</code></td><td align="left">SerializationSchema<!-- -->[T]</td><td align="left">写入的序列化器</td><td align="left">SimpleStringSchema</td><td align="left">no</td></tr><tr><td align="left"><code>partitioner</code></td><td align="left">FlinkKafkaPartitioner<!-- -->[T]</td><td align="left">kafka分区器</td><td align="left">KafkaEqualityPartitioner<!-- -->[T]</td><td align="left">no</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="容错和语义">容错和语义<a class="hash-link" href="#容错和语义" title="标题的直接链接">​</a></h3><p>启用 Flink 的 <code>checkpointing</code> 后，<code>KafkaSink</code> 可以提供<code>精确一次</code>的语义保证,具体开启<code>checkpointing</code>的设置请参考第二章关于<a href="/zh-CN/docs/development/conf/#checkpoints">项目配置</a>部分</p><p>除了启用 Flink 的 checkpointing，你也可以通过将适当的 <code>semantic</code> 参数传递给 <code>KafkaSink</code> 来选择三种不同的操作模式</p><div class="counter"><ul><li>EXACTLY_ONCE  使用 Kafka 事务提供精确一次语义</li><li>AT_LEAST_ONCE 至少一次,可以保证不会丢失任何记录(但是记录可能会重复)</li><li>NONE Flink 不会有任何语义的保证，产生的记录可能会丢失或重复</li></ul></div><p>具体操作如下,只需要在<code>kafka.sink</code>下配置<code>semantic</code>即可</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.sink</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(0, 128, 0)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> kafka <code>EXACTLY_ONCE</code> 语义说明</summary><div><div class="collapsibleContent_i85q"><p><code>Semantic.EXACTLY_ONCE</code>模式依赖于事务提交的能力。事务提交发生于触发 checkpoint 之前，以及从 checkpoint 恢复之后。如果从 Flink 应用程序崩溃到完全重启的时间超过了 Kafka 的事务超时时间，那么将会有数据丢失（Kafka 会自动丢弃超出超时时间的事务）。考虑到这一点，请根据预期的宕机时间来合理地配置事务超时时间。</p><p>默认情况下，Kafka broker 将 transaction.max.timeout.ms 设置为 15 分钟。此属性不允许为大于其值的 producer 设置事务超时时间。 默认情况下，FlinkKafkaProducer 将 producer config 中的 transaction.timeout.ms 属性设置为 1 小时，因此在使用 Semantic.EXACTLY_ONCE 模式之前应该增加 transaction.max.timeout.ms 的值。</p><p>在 KafkaConsumer 的 read_committed 模式中，任何未结束（既未中止也未完成）的事务将阻塞来自给定 Kafka topic 的未结束事务之后的所有读取数据。 换句话说，在遵循如下一系列事件之后：</p><div class="counter"><ul><li>用户启动了 transaction1 并使用它写了一些记录</li><li>用户启动了 transaction2 并使用它编写了一些其他记录</li><li>用户提交了 transaction2</li></ul></div><p>即使 transaction2 中的记录已提交，在提交或中止 transaction1 之前，消费者也不会看到这些记录。这有 2 层含义：</p><ul><li>首先，在 Flink 应用程序的正常工作期间，用户可以预料 Kafka 主题中生成的记录的可见性会延迟，相当于已完成 checkpoint 之间的平均时间。</li><li>其次，在 Flink 应用程序失败的情况下，此应用程序正在写入的供消费者读取的主题将被阻塞，直到应用程序重新启动或配置的事务超时时间过去后，才恢复正常。此标注仅适用于有多个 agent 或者应用程序写入同一 Kafka 主题的情况。</li></ul><p>注意：<code>Semantic.EXACTLY_ONCE</code> 模式为每个 FlinkKafkaProducer 实例使用固定大小的 KafkaProducer 池。每个 checkpoint 使用其中一个 producer。如果并发 checkpoint 的数量超过池的大小，FlinkKafkaProducer 将抛出异常，并导致整个应用程序失败。请合理地配置最大池大小和最大并发 checkpoint 数量。</p><p>注意：<code>Semantic.EXACTLY_ONCE</code> 会尽一切可能不留下任何逗留的事务，否则会阻塞其他消费者从这个 Kafka topic 中读取数据。但是，如果 Flink 应用程序在第一次 checkpoint 之前就失败了，那么在重新启动此类应用程序后，系统中不会有先前池大小（pool size）相关的信息。因此，在第一次 checkpoint 完成前对 Flink 应用程序进行缩容，且并发数缩容倍数大于安全系数 FlinkKafkaProducer.SAFE_SCALE_DOWN_FACTOR 的值的话，是不安全的。</p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="多实例kafka指定alias">多实例kafka指定alias<a class="hash-link" href="#多实例kafka指定alias" title="标题的直接链接">​</a></h3><p>如果写时有多个不同实例的kafka需要配置,同样采用<code>alias</code>来区别不用的kafka实例,配置如下:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">kafka.sink</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">kafka_cluster1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(0, 128, 0)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">kafka_cluster2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">kfk8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(0, 128, 0)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在写入的时候,需要手动指定<code>alias</code>,注意下<code>scala</code> api和<code>java</code> api在代码上稍有不同,<code>scala</code>直接在<code>sink</code>方法里指定参数,<code>java</code> api则是通过<code>alias()</code>方法来设置,其底层实现是完全一致的</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> val source = KafkaSource().getDataStream[String]().map(_.value)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> KafkaSink().sink(source,alias = &quot;kafka_cluster1&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> new KafkaSink&lt;String&gt;(context).alias(&quot;kafka_cluster1&quot;).sink(source);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> context.start();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定serializationschema">指定SerializationSchema<a class="hash-link" href="#指定serializationschema" title="标题的直接链接">​</a></h3><p><code> Flink Kafka Producer</code> 需要知道如何将 Java/Scala 对象转化为二进制数据。 KafkaSerializationSchema 允许用户指定这样的schema, 相关操作方式和文档请参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#the-serializationschema" target="_blank" rel="noopener noreferrer">官网文档</a></p><p>在<code>KafkaSink</code>里默认不指定序列化方式,采用的是<code>SimpleStringSchema</code>来进行序列化,这里开发者可以显示的指定一个自定义的序列化器,通过<code>serializationSchema</code>参数指定即可,例如,将<code>user</code>对象安装自定义的格式写入<code>kafka</code></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">object KafkaSinkApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">val source = KafkaSource()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.getDataStream[String]()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.map(x =&gt; JsonUtils.read[User](x.value))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    KafkaSink().sink[User](source, serialization = new SerializationSchema[User]() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      override def serialize(user: User): Array[Byte] = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s&quot;${user.name},${user.age},${user.gender},${user.address}&quot;.getBytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.sink.KafkaSink;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.FilterFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">public class kafkaSinkJavaApp {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        DataStream&lt;JavaUser&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, JavaUser&gt;) value -&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        mapper.readValue(value.value(), JavaUser.class));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        new KafkaSink&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .serializer(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        (SerializationSchema&lt;JavaUser&gt;) element -&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                String.format(&quot;%s,%d,%d,%s&quot;, element.name, element.age, element.gender, element.address).getBytes()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                ).sink(source);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定serializationschema-1">指定SerializationSchema<a class="hash-link" href="#指定serializationschema-1" title="标题的直接链接">​</a></h3><p><code> Flink Kafka Producer</code> 需要知道如何将 Java/Scala 对象转化为二进制数据。 KafkaSerializationSchema 允许用户指定这样的schema, 相关操作方式和文档请参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#the-serializationschema" target="_blank" rel="noopener noreferrer">官网文档</a></p><p>在<code>KafkaSink</code>里默认不指定序列化方式,采用的是<code>SimpleStringSchema</code>来进行序列化,这里开发者可以显示的指定一个自定义的序列化器,通过<code>serializationSchema</code>参数指定即可,例如,将<code>user</code>对象安装自定义的格式写入<code>kafka</code></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">object KafkaSinkApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">val source = KafkaSource()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.getDataStream[String]()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">.map(x =&gt; JsonUtils.read[User](x.value))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    KafkaSink().sink[User](source, serialization = new SerializationSchema[User]() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      override def serialize(user: User): Array[Byte] = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s&quot;${user.name},${user.age},${user.gender},${user.address}&quot;.getBytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.sink.KafkaSink;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.FilterFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">public class kafkaSinkJavaApp {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        DataStream&lt;JavaUser&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, JavaUser&gt;) value -&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        mapper.readValue(value.value(), JavaUser.class));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        new KafkaSink&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                .serializer(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        (SerializationSchema&lt;JavaUser&gt;) element -&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                String.format(&quot;%s,%d,%d,%s&quot;, element.name, element.age, element.gender, element.address).getBytes()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                ).sink(source);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定partitioner">指定partitioner<a class="hash-link" href="#指定partitioner" title="标题的直接链接">​</a></h3><p><code>KafkaSink</code>允许显示的指定一个kafka分区器,不指定默认使用<code>StreamPark</code>内置的 <strong>KafkaEqualityPartitioner</strong> 分区器,顾名思义,该分区器可以均匀的将数据写到各个分区中去,<code>scala</code> api是通过<code>partitioner</code>参数来设置分区器,
<code>java</code> api中是通过<code>partitioner()</code>方法来设置的</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>注意事项</div><div class="admonitionContent_S0QG"><p>Flink Kafka Connector中默认使用的是 <strong>FlinkFixedPartitioner</strong> 分区器,该分区器需要特别注意<code>sink</code>的并行度和<code>kafka</code>的分区数,不然会出现往一个分区写</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/i18n/zh-CN/docusaurus-plugin-content-docs/current/connector/1-kafka.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-CN/docs/development/alert-conf"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">报警配置</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-CN/docs/connector/Jdbc-Connector"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">JDBC Connector</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#依赖" class="table-of-contents__link toc-highlight">依赖</a></li><li><a href="#kafka-source-consumer" class="table-of-contents__link toc-highlight">Kafka Source (Consumer)</a><ul><li><a href="#基础消费示例" class="table-of-contents__link toc-highlight">基础消费示例</a></li><li><a href="#高级配置参数" class="table-of-contents__link toc-highlight">高级配置参数</a></li><li><a href="#消费多个kafka实例" class="table-of-contents__link toc-highlight">消费多个Kafka实例</a></li><li><a href="#消费多个topic" class="table-of-contents__link toc-highlight">消费多个Topic</a></li><li><a href="#topic-发现" class="table-of-contents__link toc-highlight">Topic 发现</a></li><li><a href="#配置开始消费的位置" class="table-of-contents__link toc-highlight">配置开始消费的位置</a></li><li><a href="#指定分区offset" class="table-of-contents__link toc-highlight">指定分区Offset</a></li><li><a href="#指定deserializer" class="table-of-contents__link toc-highlight">指定deserializer</a></li><li><a href="#返回记录kafkarecord" class="table-of-contents__link toc-highlight">返回记录KafkaRecord</a></li><li><a href="#指定strategy" class="table-of-contents__link toc-highlight">指定strategy</a></li></ul></li><li><a href="#kafka-sink-producer" class="table-of-contents__link toc-highlight">Kafka Sink (Producer)</a><ul><li><a href="#容错和语义" class="table-of-contents__link toc-highlight">容错和语义</a></li><li><a href="#多实例kafka指定alias" class="table-of-contents__link toc-highlight">多实例kafka指定alias</a></li><li><a href="#指定serializationschema" class="table-of-contents__link toc-highlight">指定SerializationSchema</a></li><li><a href="#指定serializationschema-1" class="table-of-contents__link toc-highlight">指定SerializationSchema</a></li><li><a href="#指定partitioner" class="table-of-contents__link toc-highlight">指定partitioner</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                  <div class="footer-left-box">
                    <div class="flex align-center footer-system">
                      <span class="system-title">About StreamPark</span>
                    </div>
                    <p>Make stream processing easier! easy-to-use streaming application development framework and operation platform</p>
                  </div>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Resource</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/intro">文档</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">版本<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/incubator-streampark" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Follow</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box">
                    <div class="d-flex align-items-center" style="margin-bottom: 30px;padding-top: 11px">
                      <div class="subscribe-input flex-fill">
                        <input class="form-control" id="email_address" maxlength="60" name="email_address" placeholder="Subscribe with us">
                      </div>
                      <div class="subscribe-submit-inner">
                        <a class="btn btn-white m-0" type="submit" href="mailto:dev-subscribe@streampark.apache.org">
                          <span><i class="fa fa-paper-plane text-white"></i></span>
                        </a>
                      </div>
                    </div>
                    <ul class="icon-bottom">
                        <li>
                          <a href="javascript:void(0)">
                            <i class="fa fa-wechat"></i>
                            <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                          </a>
                        </li>
                        <li><a href="javascript:void(0)"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="javascript:void(0)"><i class="fa fa-slack"></i></a></li>
                        <li><a href="javascript:void(0)"><i class="fa fa-facebook"></i></a></li>
                    </ul>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
            <div style="text-align: left;margin-top:30px">
                <div class="d-flex align-items-center">
                    <div>
                      <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
                        <img src="/image/apache-incubator.svg" alt="Apache Incubator logo" class="footer__logo">
                      </a>
                    </div>
                    <div>
                      <p style="font-family: Avenir-Medium;font-size: 14px;color: #999;line-height: 25px;">
                      Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
                      </p>
                  </div>
                </div>
                
                <div style="border-top: 1px solid #525252;min-height: 60px;line-height: 25px;text-align: left;font-family: Avenir-Medium;font-size: 14px;color: #999;display: flex;align-items: center;">
                  <span>
                      Copyright © 2022 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
                  </span>
                </div>
            </div></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.bc03e73f.js"></script>
<script src="/zh-CN/assets/js/main.e2f9a7ff.js"></script>
</body>
</html>