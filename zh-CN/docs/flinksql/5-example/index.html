<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-flinksql/5-example">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">使用案例 | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org//zh-CN/docs/flinksql/5-example"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="使用案例 | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="介绍"><meta data-rh="true" property="og:description" content="介绍"><link data-rh="true" rel="icon" href="/zh-CN/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org//zh-CN/docs/flinksql/5-example"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//docs/flinksql/5-example" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//zh-CN/docs/flinksql/5-example" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org//docs/flinksql/5-example" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/zh-CN/assets/css/styles.edc24a23.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.bc03e73f.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.e2f9a7ff.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apache StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-CN/">首页</a><a href="https://github.com/apache/incubator-streampark/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">下载</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/intro">文档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">社区</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of conduct</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/mailing_lists">Join the mailing lists</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_committer">Become A Committer</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_pmc_member">Become A PMC member</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_committer_process">New Committer Process</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_pmc_ember_process">New PMC Member Process</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/document">Documentation Notice</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/submit_code">Submit Code</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/team">团队</a><a class="navbar__item navbar__link" href="/zh-CN/user">用户</a><a class="navbar__item navbar__link" href="/zh-CN/blog">博客</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">基金会</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">证书</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">事件</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">安全</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">致谢</a></li></ul></div><a href="https://github.com/apache/incubator-streampark" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/flinksql/5-example" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-CN/docs/flinksql/5-example" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">简体中文</a></li></ul></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/intro">框架介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/user-guide/deployment">User guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/deployment">平台部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/quick-start">快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/development">开发环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/docker-deployment">Docker 快速使用教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/user-guide/LDAP">LDAP 快速使用教程</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/development/dev-model">Development framework</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/dev-model">编程模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/config">项目配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/alert-conf">报警配置</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/connector/Kafka-Connector">DataStream Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Kafka-Connector">Apache Kafka Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Jdbc-Connector">JDBC Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Clickhouse-Connector">Clickhouse Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Doris-Connector">Apache Doris Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Elasticsearch-Connector">Elasticsearch Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Hbase-Connector">Apache HBase Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Http-Connector">Http Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/connector/Redis-Connector">Redis Connector</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/docs/flinksql/1-query-config">Flink Sql</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/1-query-config">查询配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/2-performance-tuning">性能调整</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/3-read-write-hive">读写hive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/4-data-type">数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/flinksql/5-example">使用案例</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/syntax/1-introduce">Syntax</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/2-set">set</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/3-reset">reset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/4-create">create</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/5-insert">insert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/6-use">use</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/7-select">select</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/8-describe">describe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/9-alter">alter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/10-explain">explain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/11-drop">drop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/12-load">load</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/13-unload">unload</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/syntax/14-show">show</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/udf/1-introduce">Functions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/udf/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/udf/2-udf">自定义函数</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/format/1-introduce">Format</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/2-csv">CSV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/3-json">JSON</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/4-avro">AVRO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/5-confluent-avro">Confluent Avro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/6-debezium">Debezium</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/7-canal">Canal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/8-maxwell">Maxwell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/9-ogg">Ogg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/10-parquet">Parquet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/11-orc">Orc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/format/12-raw">Raw</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/zh-CN/docs/flinksql/connector/1-introduce">Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/1-introduce">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/2-kafka">Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/3-upsert-kafka">Upsert Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/4-jdbc">JDBC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/5-elasticsearch">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/6-file-system">FileSystem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/7-hbase">Hbase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/8-data-gen">DataGen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/9-print">Print</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flinksql/connector/10-black-hole">BlackHole</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/advanced/">Advanced extensions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-CN/docs/flink-k8s/k8s-dev">Deployment</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/k8s-dev">Flink K8s 集成支持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/k8s-pvc-integration">K8S PVC 资源使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/flink-k8s/hadoop-resource-integration">Hadoop 资源集成</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Flink Sql</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">使用案例</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>使用案例</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a class="hash-link" href="#介绍" title="标题的直接链接">​</a></h2><p>本章节主要说明各类型<code>flink sql</code>的先后编写执行顺序，另外简单写一些实际可用的案例。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="编写顺序">编写顺序<a class="hash-link" href="#编写顺序" title="标题的直接链接">​</a></h2><ol><li><strong>set</strong><ol><li>该语句主要是设置本次提交任务环境的一些参数，因此必须写到所有语句的开头，在其他语句执行之前必须先设置参数，之后的语句执行才能使用到设置好的参数。</li><li><strong>特殊设置</strong>：<code>sql 方言</code>，默认情况下，flink 使用的是自己的方言，但如果想要迁移之前一些<code>hive sql</code>语句，可能想直接使用<code>flink sql</code>引擎直接执行语句，以减少迁移的成本。
此时就可以将设置<code>sql方言</code>的<code>set</code>语句放到<code>insert</code>语句之前，而不是放到最开头。 倘若是直接将设置<code>sql方言</code>的<code>set</code>语句放到最开头，则下面的建表、创建函数之类的语句可能会出错。</li></ol></li><li><strong>create</strong><ol><li>如果需要用到 hive ，比如读写 hive 表，或者是将创建的虚拟表的信息放到 hive 元数据，就需要有创建 hive catalog 的语句。</li><li>创建虚拟表来连接外部系统。</li><li>其他<ol><li>创建自定义函数。</li><li>创建数据库。</li><li>创建视图</li></ol></li></ol></li><li><strong>load</strong><ol><li>如果想要用到 hive 模块，比如使用 hive 的一些函数，则需要加载 hive 模块，加载完 hive 模块之后，平台就自动拥有了 hive 和 core(flink) 这两个模块，默认解析顺序为<code>core-&gt;hive</code>。</li></ol></li><li><strong>use</strong><ol><li>创建了 hive 的 catalog 之后，必须写 <code>use catalog</code> 语句来使用创建的 hive catalog，否则无法连接 hive 元数据。</li><li>加载了 hive 模块之后，可以通过 <code>use modules hive, core</code> 语句来调整模块解析顺序。</li></ol></li><li><strong>insert</strong><ol><li><code>insert</code>语句是真正的 <code>flink sql</code> 任务，平台<code>1.2.4</code>版本中还要求必须有至少一个 <code>insert</code> 语句，之后的版本中，我们将计划移除该限制。</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="写在前面">写在前面<a class="hash-link" href="#写在前面" title="标题的直接链接">​</a></h2><p>以下所有的案例中涉及到的各组件版本如下：</p><ul><li>java：1.8</li><li>scala：2.12.15</li><li>flink：1.15.1</li><li>kafka：1.1.1</li><li>hadoop：2.8.3</li><li>hive：2.3.6</li><li>mysql：5.7.30</li><li>hbase：1.4.9</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-source">kafka source<a class="hash-link" href="#kafka-source" title="标题的直接链接">​</a></h2><p>案例中的 kafka 主题 <code>data_gen_source</code> 中的数据来源于 flink sql 连接器 <code>datagen</code> 生成的随机数据，频率为1秒一条，该主题将作为后面其他案例的 source 使用。</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">-- 生成随机内容的 source 表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> data_gen </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;datagen&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;rows-per-second&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.id.kind&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;random&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.id.min&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.id.max&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;10&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.product_count.kind&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;random&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.product_count.min&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.product_count.max&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;50&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.one_price.kind&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;random&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.one_price.min&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1.0&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;fields.one_price.max&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;5000&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- kafka sink 表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> kafka_sink </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> kafka_sink</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> product_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> one_price</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> data_gen</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>kafka 中 <code>data_gen_source</code> 主题的数据如下图所示：</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_data_gen_source_data-b2cd983a70c2286580349f7f9f097e18.png" width="870" height="543" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka---kafka">kafka -&gt; kafka<a class="hash-link" href="#kafka---kafka" title="标题的直接链接">​</a></h2><p>kafka 作为 source 和 sink 的案例。</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> source_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.group.id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_source_test&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;scan.startup.mode&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;latest-offset&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> sink_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    total_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;总价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_sink&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 真正要执行的任务，计算每个订单的总价</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> sink_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> product_count </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> total_price</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> source_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>运行之后，flink UI 界面如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_kafka_flink_ui-73e67e611fcca488568a89eb4df8dc59.png" width="1657" height="745" class="img_ev3q"></p><p>sink 端的 kafka 接收到以下数据</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_kafka_sink_data-b8b551861b2136077d7c683958cea16b.png" width="871" height="534" class="img_ev3q"></p><p>可以看到，value 中两个数字使用空格分隔，分别是订单的 id 和 订单总价。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka---hive">kafka -&gt; hive<a class="hash-link" href="#kafka---hive" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="写入无分区表">写入无分区表<a class="hash-link" href="#写入无分区表" title="标题的直接链接">​</a></h3><p>下面的案例演示的是将 kafka 表中的数据，经过处理之后，直接写入 hive 无分区表，具体 hive 表中的数据什么时候可见，具体请查看 <code>insert</code> 语句中对 hive 表使用的 sql 提示。</p><p>hive 表信息</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.order_info</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">product_count</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">one_price</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/order_info&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659250044&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>flink sql 语句</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">-- 如果是 flink-1.13.x ，则需要手动设置该参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.dynamic-table-options.enabled&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;true&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 source，此处使用 temporary ，是为了不让创建的虚拟表元数据保存到 hive，可以让任务重启是不出错。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 如果想让虚拟表元数据保存到 hive ，则可以在创建语句中加入 if not exist 语句。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">temporary</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> source_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.group.id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_source_test&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;scan.startup.mode&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;latest-offset&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">order_info</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 下面的语法是 flink sql 提示，用于在语句中使用到表时手动设置一些临时的参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/*+</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">OPTIONS(</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置写入的文件滚动时间间隔</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.rolling-policy.rollover-interval&#x27; = &#x27;10 s&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置检查文件是否需要滚动的时间间隔</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.rolling-policy.check-interval&#x27; = &#x27;1 s&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- sink 并行度</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.parallelism&#x27; = &#x27;1&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">)</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> product_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> one_price</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> source_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>任务运行之后，就可以看到如下的 fink ui 界面了</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_flink_ui-a0cd0d1e1b3a424426a54c0ba5a64b4a.png" width="1641" height="764" class="img_ev3q"></p><p>本案例使用 streaming 方式运行， checkpoint 时间为 10 s，文件滚动时间为 10 s，在配置的时间过后，就可以看到 hive 中的数据了</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_hive_data-67ec5d47eeafda2ad6cb78e776ffba8f.png" width="362" height="885" class="img_ev3q"></p><p>从 hdfs 上查看 hive 表对应文件的数据，如下图所示</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_hive_table_hdfs_file-843a2144f50c1a47cb0864fa3afd2515.png" width="1162" height="918" class="img_ev3q"></p><p>可以看到，1 分钟滚动生成了 6 个文件，最新文件为 .part 开头的文件，在 hdfs 中，以 <code>.</code> 开头的文件，是不可见的，说明这个文件是由于我关闭了 flink sql 任务，然后文件无法滚动造成的。</p><p>有关读写 hive 的一些配置和读写 hive 表时其数据的可见性，可以看考<a href="/zh-CN/docs/flinksql/3-read-write-hive">读写hive</a>页面。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="写入分区表">写入分区表<a class="hash-link" href="#写入分区表" title="标题的直接链接">​</a></h3><p>hive 表信息如下</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.order_info_have_partition</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">product_count</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">one_price</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PARTITIONED </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">minute</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单时间，分钟级别&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">order_id</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/order_info_have_partition&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659254559&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>flink sql 语句</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">-- 如果是 flink-1.13.x ，则需要手动设置该参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.dynamic-table-options.enabled&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;true&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 source，此处使用 temporary ，是为了不让创建的虚拟表元数据保存到 hive，可以让任务重启是不出错。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 如果想让虚拟表元数据保存到 hive ，则可以在创建语句中加入 if not exist 语句。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">temporary</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> source_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    event_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">TIMESTAMP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> METADATA </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.group.id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_source_test&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;scan.startup.mode&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;latest-offset&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">order_info_have_partition</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 下面的语法是 flink sql 提示，用于在语句中使用到表时手动设置一些临时的参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/*+</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">OPTIONS(</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置分区提交触发器为分区时间</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.partition-commit.trigger&#x27; = &#x27;partition-time&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">--     &#x27;partition.time-extractor.timestamp-pattern&#x27; = &#x27;$year-$month-$day $hour:$minute&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置时间提取器的时间格式，要和分区字段值的格式保持一直</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;partition.time-extractor.timestamp-formatter&#x27; = &#x27;yyyy-MM-dd_HH:mm&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置分区提交延迟时间，这儿设置 1 分钟，是因为分区时间为 1 分钟间隔</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.partition-commit.delay&#x27; = &#x27;1 m&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置水印时区</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.partition-commit.watermark-time-zone&#x27; = &#x27;GMT+08:00&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- 设置分区提交策略，这儿是将分区提交到元数据存储，并且在分区目录下生成 success 文件</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.partition-commit.policy.kind&#x27; = &#x27;metastore,success-file&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    -- sink 并行度</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    &#x27;sink.parallelism&#x27; = &#x27;1&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">)</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">-- 不要让分区值中带有空格，分区值最后会变成目录名，有空格的话，可能会有一些未知问题</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    date_format</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;yyyy-MM-dd_HH:mm&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">minute</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> order_id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> source_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>flink sql 任务运行的 UI 界面如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_partition_table_flink_ui-84f0326a6e1c66214900d3bd3e85ea10.png" width="1667" height="831" class="img_ev3q"></p><p>1 分钟之后查看 hive 表中数据，如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_partition_table_data-d8be3d5e7831d69991672c61599c34e5.png" width="543" height="876" class="img_ev3q"></p><p>查看 hive 表对应 hdfs 上的文件，可以看到</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_to_hive_partition_table_hdfs_file-142fe6aa60ec2c8791502dd14feceb4c.png" width="1159" height="678" class="img_ev3q"></p><p>从上图可以看到，具体的分区目录下生成了 <code>_SUCCESS</code> 文件，表示该分区提交成功。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hive---hive">hive -&gt; hive<a class="hash-link" href="#hive---hive" title="标题的直接链接">​</a></h2><p>source，<code>source_table</code>表信息和数据</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.source_table</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col1</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col2</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/source_table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659260162&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>source_table</code> 表中的数据如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="195" height="119" class="img_ev3q"></p><p>sink，<code>sink_table</code>表信息如下</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.sink_table</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col1</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col2</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> array</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">string</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;保存 collect_list 函数的结果&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col3</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> array</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">string</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;保存 collect_set 函数的结果&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/sink_table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659260374&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>sink_table</code> 表数据如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="341" height="69" class="img_ev3q"></p><p>下面将演示两种 sql 方言，将 <code>source_table</code> 表数据，写入 <code>sink_table</code> 表，并且呈现上面图示的结果</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-flink-方言">使用 flink 方言<a class="hash-link" href="#使用-flink-方言" title="标题的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 加载 hive module 之后，flink 就会将 hive 模块放到模块解析顺序的最后。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 之后flink 引擎会自动使用 hive 模块来解析 flink 模块解析不了的函数，如果想改变模块解析顺序，则可以使用 use modules hive, core; 语句来改变模块解析顺序。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">load</span><span class="token plain"> module hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> overwrite test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sink_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> col1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> collect_list</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> collect_set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> col3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">source_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">group</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">by</span><span class="token plain"> col1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用hive方言">使用hive方言<a class="hash-link" href="#使用hive方言" title="标题的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 加载 hive module 之后，flink 就会将 hive 模块放到模块解析顺序的最后。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 之后flink 引擎会自动使用 hive 模块来解析 flink 模块解析不了的函数，如果想改变模块解析顺序，则可以使用 use modules hive, core; 语句来改变模块解析顺序。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">load</span><span class="token plain"> module hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 切记，设置方言之后，之后所有的语句将使用你手动设置的方言进行解析运行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 这儿设置了使用 hive 方言，因此下面的 insert 语句就可以直接使用 hive sql 方言了，也就是说，下面可以直接运行 hive sql 语句。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.sql-dialect&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- insert overwrite `table_name` 是 flink sql 方言语法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- insert overwrite table `table_name` 是 hive sql 方言语法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> overwrite </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sink_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> col1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> collect_list</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> collect_set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> col3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">source_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">group</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">by</span><span class="token plain"> col1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lookup-join">lookup join<a class="hash-link" href="#lookup-join" title="标题的直接链接">​</a></h2><p>该例中，将 mysql 表作为维表，里面保存订单信息，之后去关联订单流水表，最后输出完整的订单流水信息数据到 kafka。</p><p>订单流水表读取的是 kafka <code>data_gen_source</code> 主题中的数据，数据内容如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_data_gen_source_data-b2cd983a70c2286580349f7f9f097e18.png" width="870" height="543" class="img_ev3q"></p><p>mysql 表 <code>dim.order_info</code> 信息为</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">order_info</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">user_name</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">varchar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属用户&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">order_source</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">varchar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DEFAULT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属来源&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token keyword" style="color:rgb(0, 0, 255)">InnoDB</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CHARSET</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>mysql 表 <code>dim.order_info</code> 数据为</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="352" height="143" class="img_ev3q"></p><p>实际执行的 flink sql 为</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 订单流水</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">temporary</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">-- 一定要添加处理时间字段，lookup join 需要该字段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proc_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> proctime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.group.id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_source_test&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;scan.startup.mode&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;latest-offset&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 订单信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> order_info </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">KEY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> ENFORCED </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    user_name string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属用户&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_source string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属来源&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;jdbc&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;url&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;jdbc:mysql://node01:3306/dim?useSSL=false&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table-name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;order_info&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;username&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;root&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;password&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;root&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> sink_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">KEY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> ENFORCED </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    user_name string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属用户&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_source string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属来源&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    total_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;总价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;upsert-kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_sink&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;key.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 真正要执行的任务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> sink_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">order_source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">product_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">one_price</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">product_count </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> total_price</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> order_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 一定要添加 for system_time as of 语句，否则读取 mysql 的子任务会被认为是有界流，只读取一次，之后 mysql 维表中变化后的数据无法被读取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">left</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">join</span><span class="token plain"> order_info </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> system_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">of</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">proc_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">on</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>flink sql 任务运行之后，flink UI 界面显示为</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_lookup_join_mysql_flink_ui-c563d3ee3b2a3316f78554dd4cb6ae27.png" width="1651" height="748" class="img_ev3q"></p><p>最后查看写入 kafka 中的数据为</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_lookup_join_mysql_sink_kafka_data1-887660314308da7e4dd346cea22ae9e7.png" width="871" height="551" class="img_ev3q"></p><p>此时，修改 mysql 中的数据，修改之后为</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="355" height="145" class="img_ev3q"></p><p>再查看写入 kafka 中的数据为</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_lookup_join_mysql_sink_kafka_data2-c42c5491392c4db1b55365a4a8cbbe39.png" width="874" height="550" class="img_ev3q"></p><p>其他</p><p>如果 kafka 中的订单流数据中的某个订单 id 在维表 mysql 中找不到，而且 flink sql 任务中使用的是 left join 连接，
则匹配不到的订单中的 user_name 和 product_count 字段将为空字符串，具体如下图所示</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_lookup_join_mysql_sink_kafka_data3-cfb2f9be4251b77375e519474cfd2c33.png" width="872" height="551" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="temporal-join时态连接">temporal join(时态连接)<a class="hash-link" href="#temporal-join时态连接" title="标题的直接链接">​</a></h2><p>该案例中，将 upsert kafka 主题 <code>order_info</code> 中的数据作为维表数据，然后去关联订单流水表，最后输出完整的订单流水信息数据到 kafka。</p><p>订单流水表读取的是 kafka <code>data_gen_source</code> 主题中的数据，数据内容如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_data_gen_source_data-b2cd983a70c2286580349f7f9f097e18.png" width="870" height="543" class="img_ev3q"></p><p>订单信息维表读取的是 kafka <code>order_info</code> 主题中的数据，数据内容如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3MAAABvCAYAAABGtZkHAAAamklEQVR4Xu2dPZLkurFGZ0/PmIjeirw2eheKuOZ4Y8uULWPMduRoATLGvhEKreBZ1+cb8BdIZCaSLBKsuu+ciC+6SIBJgN1J4CNZzS/DL/744w+EEEIIIYQQQi+kL5g5hBBCCCGEEHo9jWbut99+QwghhBBCCCH0QsLMIYQQQgghhNALqjBzANAH8g2gH+QbQD/IN4B+qGZOPoeJEDpf5BtC/US+IdRP5BtC/YSZQ+gmkW8I9RP5hlA/kW8I9RNmDqGbRL4h1E/kG0L9RL4h1E+YOYRuEvmGUD+Rbwj1E/mGUD9h5l5SP4dvX78MX758Gd5/aMvoFUS+IdRP5Nsr68fw/uV9+FGtR88q8u1C/fw2fP3ydfj2UylD/y+FmXs2jUk6GbNJdcL+/PZ1+PL+w1xGryHy7Xn1411cGFnykjx7WZFv9yrllJY/4/j19dvwU9lmE2bu1US+PaYxX4q54KyUQ5g5JISZeyb9eK/N2zyJzCeWKcm/fvtpLu/XdGePu3p9Rb49r0ozlyaS5Meri3y7WeP4Jg1ZdOzBzL2ayLezdPfffjRH0Z3CzD2NnAmjGASleZPL+0Wy3iHy7Xm1mbkpLx/LL/QMIt/uljLGjRcrIxPVuye0aK/It7N0998+88NXEGbuWZQMm/moSUrm6Y5deev9ffirWE4JPz62ItZtcbb60wS1XGe3AZ0t8u15NZm5aRDTjZyWS0p9N69RT5Fv90s+all9RUB8zaC8Oz6PZdIAymU1N+u2oGtFvp0lxcwVf/Pz/PDHljtj3ow3AbQcsPOjnjsa80M3T6NtWUxiuQ9M4zFh5p5F7qSvvDIi78QVy9XAtmgzhHVMrrzcIfLtebVeNFFz0sklkcfVd+/QbSLfnkDF+CTHnV/L71m+FU+kRM2ck5uyLehSkW9nKWLmsrFqMU7LRZKqrpEfMq9WyRxq5Wm0LVPc4oaD+ig2iggz9yxqmrktAV0zt15JEd+9y66M5MrvKDDg9RX59rxaTNho6mReurmUD5bKIIxuE/n2DGpPHuu7A2l90My5uSnbgq4U+XaWlHHENWjOspsfxtzRmB/aeWrsu1rW4mrrUESYuafRlEjqH7G4WuGbuUXLVY8sieWkVNRV940uE/n2vNruqM15lD8K5ubSNMilfKweIUO3inx7Di15UeXH/OiW/pTJDjPn5CbqJ/LtLJ1s5pr5IeaOcn7YzFNj39WyNu/U1qGIMHNPpOlKh7gqMidO/sctzZt8zPJbfjt8TYzaLP54XxKQBLpD5Nvzqnw8cr5iuU48vVz6Y8rZr+/De3Y3Hd0v8u1JNI5pX3/liMgPMdGcxkPLzG3b1vWc3ETdRL6dpRPNnJcf5txRzA+beWrtWy7XF0rLWGiPMHPPptm8bbev6wmha+bm5XV75crnUpYn9HrLvHnVBp0l8u15VX/XbTZ0zS+Ab9uTS88l8u1ZNE/iqvxY7ghM+vprkqnemfujfMSrrPdHMzdRH5FvZ+lMM7dsq+eHNXcs54etPHX2rZi59/f80U+M3FFh5hC6SeTbn1fyAgu6X+QbQv1EviFfPBF2pjBzCN0k8u1PquKqKXoWkW8I9RP5hnxh5s4UZg6hm0S+/fm0PKbCAPV8It8Q6ifyDfnCzJ0pzBxCN4l8Q6ifyDeE+ol8Q6ifMHMI3STyDaF+It8Q6ifyDaF+qszcshIhdL3IN4T6iXxDqJ/IN4T6qbozBwDXkwY6AOgD+QbQD/INoB8p3zBzADfAYAfQjzPzLf2TmxaROgB/Vs7MNwDwCZi534fvb1+Gj0+5HgAeIR/sfv/+lr04M+ljIOUAzmNvvpXlpTGTyxbReufBeA3PQWHmfv8+vGW5VP59fg4fS9nb919/wRnedl5Zhb6P+jzQiPX5kdWrzxkjY7uMskSk3a0YRn9GIvETTr36uFhtsdvhxnD2DcdomrnlF8LBBjiXfLD7/CDHAK7kkXxLY6C3bBGtdx6YOXgOtnxLE/634fvmoH5N5Jfl8u91nG+uf7zedl6ZxNuHIJk1aY4WhMFS46xmzzM/jXY3Y3j9CcQf8evFzo9eO7wY/r7hGL6ZSwf57WP4YHAAOJ1tsEsnRU5mAFfySL5JUyaXHydNcD6G7+vVbNE+90p2fnWc8RqegzXfkjkRf5DbRH/6u19Lc8PkbeeVVTj7KBAmo4WIk/Y/5u2nFX9ottuMUezL6Y8XP1ovfH502uHFcPcNR3HM3PLL4EofwBWUVy7zxxHIN4CzOZpvuXFbPsufy+eoauY2LXcFxqvz+eRNXskuJ5Fv2yX1Mb7XH4Ae2N+Zy/6exxsG+Z0wz1AdLAvuQ95ZamHWN82iht4WN0awPxNeWU5eL3h+dNsRjDESbSN4mGYu/aFOAwRmDuAK1sFuPHHnJzPnqhYAHOJovuXma/ksfz7ONPnZxlmvTamucZWe8RqeBN3MTX+fxcUH0xDkiO0KvLIhuA9tncF4/kgGxajvGbECp91ejFB/Ek78AlEven702hGNIfcNh9HNXOG4GRwArkAf7CZ47ADgXI7mW343Tf6Un611crmmnpDJNk2PYC2aJ3rKpE9uB3AHdb5NFyyKibt7dydfZ03467IiT1IiRPZRGRMlToUSJ6HkZE3d7gIvRqQ/rfgrsXrqOSXUjo06RmzfEEM1c/V/oZnEQQc4j3qw26hPfADwCHvzLR/78nX5T/l577oNORHKr2RPk561fcVEL5VxZw6ejyLf5rtZ9d+l+PuVJsbcbvDLChr7SDXyR5V3oJ03tPgFkXa7MRr9icRPROsNRj9b7RAUMXbsG2KoZq6EwQHgCtbBrroqmHLOPikCwH6O5lvLwEmTJpdz7LLJsK13API2yknSuLwZP74zB89I+Viz9TdZPmZXfA/N284rq3D2sZbbd5RWqvOGvAAzI/M1J9puL4bXn13xjXpVP63zo9MOL4a3bzgMZg7gJvIrl+XdcGWAAICHOJpvmgHT1i0cK5smhh8f+n+zLNpb/cfKaYzWywDuYck360mv7W90vpAx/v1uBsDbzivT0fexlfnngIXQecMxYuF2yxhy2eiPGz+L4daryrN+BtsxVdVjtPYNxwiYOQC4Au+xLwA4l6P5liYaEm1dwlqfo9eJTygBXoGj+QYA+8HMAdwEgx1AP47k23LVuLVuWR9Br4eZgz8XR/INAI6BmQO4CQY7gH6QbwD9IN8A+oGZA7gJBjuAfpBvAP0g3wD6UZm5tAIhhBBCCCGE0POLO3MAN5CSDwD6QL4B9IN8A+gHZg7gJhjsAPrxSL7p/7TE58g2EvnvuyXaOoBn4JF8A4B92GZufvnoJP2dGQBwHH2w472OAFfwSL7lpkkaKLmc45VJpHGLbCvbtWdbgCsp8m1+UfTyt1nmm/2uMnc7r6xC38fud55F5sXVu9gEkXa3Yhj9GYnEH4nGONiOBa0vkeMIu9DNnDj4xZvdAeAUtMnlMriQbgDnciTftgnHpHy99lnilbWIbGu1I7ItwJVs+SZeuzHOL5fl8mJKOdf0tvPKJN4+BMlkBE2JGmc1KZZBCbS7GcPrTyD+VBCOMZapx8SLMaP1JXIcYTe6mZNozhoAHqKaXKY8e/sYPgJ3CgBgH4/kmzRHy7JcfyZe7MVcLlrW5eUAd7LmW5rQiwT7/FhyLhkHY6LvbeeVVTj7KNj5rkcRJ+3/S9r+04o/NNttxij25fTHix+NMZ4Xc/Mm6lrrjxyPhPn7gD2EzBzOGeB8ysllusqVBpLYY18AsI9H8k2aI8tARaUh62iS5OuszwB3UF08WclMk2ocLEN1sCy4j73zXLP+LnOit8WNEezPhFHmxii3Me/MuTEyvL4MznGEXfhmbvwlpEFE+QUBwEPkg106ob1No1tocgkA+9ibb9JISUN1tWFqxZdt6tk2gBa6mZvybcq9Id2+EUbBMARyuwKvbAjuQ1tn0JoXN8zLhtNuL0aoPwknfjNGWp7PL5qRSzRjzFh9aR1H2IVv5laMXxIAHGYd7IorXPbkEgCO80i+aeZIW7cgy+RyhNY20shh5uCZqM3cZBAKcxG6u6Nst1KXTY/3zUqJHdlHZUyUOBVKnIRlXgrqdhd4MSL9icS3Yoz7zuKN33tT2uLFyPH6MmJsB7sImrnpD1v9ewaAQyyD3fJPGKTMEzEA7OZIvi2mSJoja/2Ctl5btyDb4mmpn//0PgPcQWHm5rsw9RwyTeTt713Z2w1+WUFjH6nGh57/LdR5sRK/INJuN0ajP5H4XozK2Fpmy4mRY63PUI8j7EI3c+FfJgAcpb5ymYjdKQCAfRzJt9w0aWZKftaWc7wySaSu1Y7ItgBXUtwJN81F+Shg8f0pbzuvrMLZx1oemN9G58WeeYm224vh9ScavxkjcGfOi5Ej+xI9jrAL3cwN8y9mHcA40ABnc2RyCQDHOJJvR8ybXM7xyiSRula7tHYD9KR1J3zLuemRwHF9Nsn3tvPKdPR9bGWxOW5oXizNS0a43TKGXDb648YPxpiKkoFT+rknxkK1jWyncRxhF6aZA4Br0SeXAHAFR/ItnxBFiNSL1ElE6i11ZF1rPUAvjuQbABwDMwdwEwx2AP3Ym2+5EcpNnSZZ36NVT8b18Op5ZQBXszffAOA4mDmAm2CwA+gH+QbQD/INoB+YOYCbYLAD6Af5BtAP8g2gH5WZSysQQgghhBBCCD2/uDMHcAMp+QCgD+QbQD/IN4B+YOYAboLBDqAfr5hv2j9akeUAz8gr5hvAq2Kbufnlg8sgUr0HAwAeohjsive66O+oAYDjHMk3aaY07amb15fIel7dBW//AHdS5Js7n3TeVeZt55VV6Ptw38umETlvKO9VK4i0uxXD6E9BI0bdd/leO2V9xfSezqmeeF+c189wfIhimDnxEsXxwPNiP4AzWQc7cdIdT7LqGR4AjnJGvqXJR5Q9dTUi2+d1rM8Ad7CZOW8+OZmBJf3KXPS288ok3j4EyawFzZEaZzV7lkEJtLsZI9CfZoxUxTCSoo1jfOOYFDGKY+f1czKiRfuN+BBHN3PplyJ+y/YvHgCOYD6G0riiBgD7OSPf9pikPXU1vO2Xq92LlnV5OcCdrPnmzifTxF7eEZqXve28sgpnHwXCgLQQcdL+x7tTn1b8odluM0axL78/sRjJEBp9TfUKcyX211w/+P1U4xttgTC6mavgYAOcjTW5VK+0AcBDnJFve0zSnroJadA0SSwDp9UF6ImVb8V8ctfE/mBZcB97zgMJs75pFjX0trgxgv1xY4zblOeWrStlPPPO2dyO76N5nA1kVWnh6O8cogTM3HRL940jDXAq1WA3nnxbJ0UAOMIZ+dYySdJ8Se2hVV/Gzeu3tgW4mirfRsR8snqs0ZrYe/NQr2wI7kNbZ9A6b7gmKsdptxcj1J/BjzGW5dvIO3WZ2dOMXGI+DqsJrEzaguznFHvZbvruntJ+2EXDzE0HXf1jA4CH0Ae7hHFyBoDDHMk3acY0aWjrtXUerfr5/mVbWtsCXE2db8p8sjIAWi4q263UZdNjhrOSY4jsozJISpwKJU7CM1ErdbsLvBiR/iS8GArFY5B5vPH7d0qcUDuMfq6GOJV92o98QhjbzEnXDQCnUg92G/bz/wBwhDPyLWqStHrauoV10hjQUj//6X0GuIMi38z5ZJrsW9/rWpa17Qa/rKCxj1TjQzEcAdTzhhK/INJuN0a7P+56g+L7iE2TNq/36kX6OSL6A4fQzVz4lwAAR1kHu/DJEwCOcka+RU2SVk9b5xGpbxm4yLYAV7LmmzufLB/BK76H5m3nlVU4+1jLA/kfPW94Jirabi9Gsz8zXoyqLynmXHfcLnBnbhBmNm23xHT7WR43s/2wC9XMTc+w1lcEOd4A55FfuSxzThkgAOAhzsi3iEmy6ljrLSL1LQO3fI7EALiCJd/a88npUbxxfWYwvO28Mh19H1tZ7BwQOm84JircbhlDLrv9mZHbiGW3L6OBU8pkzLwdZmyln3l8q/2wC9XMAcD1eI99AcC5nJFvafLRwqpjrbeI1F/qyLrWeoBenJFvABADMwdwEwx2AP3Ym2/yqrKnI/UtovUSXj2vDOBq9uYbABwHMwdwEwx2AP0g3wD6Qb4B9AMzB3ATDHYA/SDfAPpBvgH0ozJzaQVCCCGEEEIIoecXd+YAbiAlHwD0gXwD6Af5BtAPzBzATTDYAfTjjHy76h+KyH+Q4ulIfYDenJFvABCjbeaq90oAwBkUg938ks1lAla9dwYAHmJvvklT5GnvNhJtnYZXzysD6E0835x3pnnbeWUV+j6a70OTFO9fM+bFrTlzpN2tGEZ/CloxvL4UbXRiOPXqY2u8n85qP+zCN3PrL9v5ZQLAIbbBTry0dDxBGi8kBYBDPJJvaRzUfkry9ZHP3joNq561HuAuYvn2+/D9bTM0owHY3iztbOeVSbx9CNKc1zIXwhypcZpz5kC7mzEC/WnFcPsyGa0ivnpM/HqfH4ZRjbQfdmOaufSLGN/8/tlw9wBwiHWwSydecTKzT4QAcISj+WYZMc1AWeXW53ydXK8tyzgtAdxFLN+SIcjml7nJ8LbzyiqcfRQIo9VCxAnNmRvtNmMU+/L7E4shyMvS58K8GcfFrZcMm7LNiN9+OIZp5lY40ACXYH+nwDh5AsBh9uabZoi0ZWmw9nyW66I/5WeNVjnAlYTyzTUEkoNlwX3svUNk1t81Z9bb4sYI9seNISj6sie+WS99Li8srYfK3Q6OgpkDuAl9sJseQXjjzAZwKkfzLZ+Q5NKwzJb1WVsny60yWU/SKge4klC+VY81WhN7L0+9siG4D22dwTgnnu9+afXDc2an3V6MUH8GP8aC2pfJiG3eLn33TYnv1Rvj5ttkd+qi7YddYOYAbqIe7KaTo3pyB4CHOCvfPJNkmS3rs7ZOlltlXj1tGaAnoXwL3aVRtlupy6bHDGclpxHZR2UwlDgVSpxEaM5ct7vAixHpT8KLUSFirCYvtfHTfmQyWm+Yjud4GKPth11g5gBuohjs5pOiOmYAwMOckW8tg7SUa/XWiaFRtuen/BxZBuhJLN/SRN75/pS53eCXFTT2kWp8OMbKQf2enhK/INJuN0a7P+56A7UvI2J/Jn690Pck4TCYOYCbWAe7yMkdAB5ib77l5qsluY2HVq5tpy3LfeW0lgF6Esu38lHD6rtb1nZeWYWzj7U8cGeountn3FHy5szRdnsxmv2Z8WK4fSn7Zcb36lXxU5uXtgTbD7vAzAHcxDLYTc+a1xNEzm8A53FGvrUMUqs8odXR1mlY9Zb1S18A7iaeb9Mjh+P6zAB423llOvo+tjLFlCmU+zW2cebM4XbLGHLZ7c+M3EYsu31ZX20g4suYVr2xqhM/0n7YRdvMAcAl1N8pAICrOCPf0uTDQ07SLEm0dRqynhdPWw/QizPyDQBiYOYAboLBDqAfj+SbZ8RyWuUJrY62LkfuP9KWRKQOwBU8km8AsA/MHMBNMNgB9IN8A+gH+QbQD8wcwE0w2AH0g3wD6Af5BtCPysylFQghhBBCCCGEnl+Fmfufvw0IoQ5KyQcAfSDfAPpBvgH0AzOH0E1isAPox1n5dsU/Fcn/wUlLR+oD9OasfAOANq6Z+9dS63+H4S/KZBQhdFzqYCff4wIAp7A33yxTZH1ellvSsNZLvHpeGUBvinybX5a95ED5XjXnnWPedl5Zhb6P8HvfFvL3qhnnDe+cMhJpdyuG0Z92WcYp7ZhR600vB5/il++Zq4+73Bb2Ypq5v/8ycP/65/T5L//+VeE/9WQUIXRc1eRyHSg4sQGczSP5lurJz/m6R4nGsupZ6wHuYss38VLuceK/LE8T/sVIjJP81VV423llEm8fgnROsAyQ9tJtGad5Tgm0uxnD649XlnNGO2aMep8fmUEUx7Uog1MwzVy6K/fXZeL5j2H4b76MEHpY+eQyndzGq1ef2hUuAHiUR/JNmrmzzZMWU1vW2uEJ4C7WfEsTeTFz3ybzyVRk+ZcbJm87r6zC2UeBMDgtRJzQOaXRbjNGsS+vP05Z9NjOn9V2COx6oh0FyXDuOM4QQjdzybyJRyuTufv7P+oJKULomKo7BQlzoAGAR9ibb5YxusIkLTGjP+VnjVY5wJWo+TaSmaaUf8WdMM9QHSwL7sO+i6Vj1nfOKTV6W9wYXn+8MhejnteOHFlvbsf30ezNhm+NnfZVnlu1wwj70M3cP4fqe3KYOYTOlTrYyZMiAJzC3nzTzFA+Acn1KJ5Js8pkPUmrHOBK1HybHwN8W2b21WONhqmQ2xV4ZUNwH9o6g/GcIQ1KhnNOKXHa7cXw+uOVmRxsR46sNx+j1aTlJnMsy9vEnboz0M0cd+YQulzqYCdPigBwCnvzzTJDy3qv3JKFZ9KsMq+etgzQkzrfpjsyhWkI3UlStlupy6ZH/2YlNxHZR2WClDgVSpyEc07ZqNtd4MXw+uOVqTzQjhxZb2c77EdkIYpu5v7Gd+YQulr1YDfUJ0UAOIW9+WYZseXzmWZJxmz9lJ8jywA9KfJN3qlZSZN8eUdHLmvbDX5ZQWMfqcaHY2gcVBOixC+ItNuN4fXHKxM83I6Mqt6vdmDmumKaufTfLP/77+kz/80SofO1d3IJAMd5JN8sE3WWYZKGcVknl719t5YBerLmm2saykf8iu+hedt5ZRXOPtZy22isVHfvDIPinVOi7fZiuP3xyjJOaUeGUq8waKl8OXbVcUxtDuwDXEwzl8R75hC6To9MLgFgH4/km2WizjJM0ThWvWW9NHwAd7HkW/1OsUmbkZge9RvXZ5N8bzuvTEffx1ammDKFcr/GNs45JdxuGUMuN/ujlGUxzmuHtz5rhygLHUfYhWvmEELXSZ1cAsAlPJJvadKRf5bLjxKNIevJtrTWA/TikXwDgH1g5hC6SQx2AP04km+aKZLLC9uV5rYk2rocua0VRxKpA3AFR/INAI6BmUPoJjHYAfSDfAPoB/kG0A/MHEI3icEOoB/kG0A/yDeAflRmLq1ACCGEEEIIIfT8wswhhBBCCCGE0AsKM4cQQgghhBBCLyjMHEIIIYQQQgi9oDBzCCGEEEIIIfSCwswhhBBCCCGE0AsKM4cQQgghhBBCL6j/A4q8m8/rC6WpAAAAAElFTkSuQmCC" width="883" height="111" class="img_ev3q"></p><p>实际执行的 flink sql 为</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 如果 source kafka 主题中有些分区没有数据，就会导致水印无法向下游传播，此时需要手动设置空闲时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.exec.source.idle-timeout&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1 s&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 订单流水</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">temporary</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">-- 定义订单时间为数据写入 kafka 的时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_time TIMESTAMP_LTZ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> METADATA </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;timestamp&#x27;</span><span class="token plain"> VIRTUAL</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    WATERMARK </span><span class="token keyword" style="color:rgb(0, 0, 255)">FOR</span><span class="token plain"> order_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> order_time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;data_gen_source&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.group.id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_source_test&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;scan.startup.mode&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;latest-offset&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 订单信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> order_info </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">KEY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> ENFORCED </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    user_name string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属用户&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_source string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属来源&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    update_time TIMESTAMP_LTZ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> METADATA </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;timestamp&#x27;</span><span class="token plain"> VIRTUAL</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    WATERMARK </span><span class="token keyword" style="color:rgb(0, 0, 255)">FOR</span><span class="token plain"> update_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> update_time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;upsert-kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;order_info&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;key.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建连接 kafka 的虚拟表作为 sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> sink_kafka</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">KEY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> ENFORCED </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单id&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    user_name string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属用户&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_source string </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;订单所属来源&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    product_count </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;购买商品数量&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;单个商品价格&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    total_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">comment</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;总价格&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;upsert-kafka&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;topic&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;for_sink&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;properties.bootstrap.servers&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;node01:9092,node02:9092,node03:9092&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;key.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.format&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;csv&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;value.csv.field-delimiter&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 真正要执行的任务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">into</span><span class="token plain"> sink_kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">order_source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">product_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">one_price</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">product_count </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">one_price </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> total_price</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> order_flow</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">left</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">join</span><span class="token plain"> order_info </span><span class="token keyword" style="color:rgb(0, 0, 255)">FOR</span><span class="token plain"> SYSTEM_TIME </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OF</span><span class="token plain"> order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">order_time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">on</span><span class="token plain"> order_flow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> order_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>flink sql 任务运行的 flink UI 界面如下</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_temporal_join_flink_ui-0ca2aacfe483b930810bdce5b5aea793.png" width="1645" height="790" class="img_ev3q"></p><p>查看结果写入的 kafka <code>for_sink</code> 主题的数据为</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_temporal_join_kafka_sink_data1-b34206c5116903a1bcfd54a85ed61c29.png" width="872" height="555" class="img_ev3q"></p><p>此时新增数据到 kafka 维表主题 <code>order_info</code> 中，新增的数据如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="887" height="143" class="img_ev3q"></p><p>再查看结果写入的 kafka <code>for_sink</code> 主题的数据为</p><p><img loading="lazy" alt="img.png" src="/zh-CN/assets/images/kafka_temporal_join_kafka_sink_data2-6e7fdaffdb8da549b14e0b3a051ab38a.png" width="872" height="553" class="img_ev3q"></p><p><strong>注意</strong></p><p>经过测试发现，当将 upsert kafka 作为 source 时，主题中的数据必须有 <strong>key</strong>，否则会抛出无法反序列化数据的错误，具体如下</p><div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[INFO] [2022-07-31 21:18:22][org.apache.flink.runtime.executiongraph.ExecutionGraph]Source: order_info[5] (2/8) (f8b093cf4f7159f9511058eb4b100b2e) switched from RUNNING to FAILED on bbc9c6a6-0a76-4efe-a7ea-0c00a19ab400 @ 127.0.0.1 (dataPort=-1).</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">java.io.IOException: Failed to deserialize consumer record due to</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.KafkaRecordEmitter.emitRecord(KafkaRecordEmitter.java:56) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.KafkaRecordEmitter.emitRecord(KafkaRecordEmitter.java:33) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.base.source.reader.SourceReaderBase.pollNext(SourceReaderBase.java:143) ~[flink-connector-base-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.api.operators.SourceOperator.emitNext(SourceOperator.java:385) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.io.StreamTaskSourceInput.emitNext(StreamTaskSourceInput.java:68) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:519) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:203) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:804) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:753) ~[flink-streaming-java-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:948) ~[flink-runtime-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:927) ~[flink-runtime-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:741) ~[flink-runtime-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.runtime.taskmanager.Task.run(Task.java:563) ~[flink-runtime-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_311]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Caused by: java.io.IOException: Failed to deserialize consumer record ConsumerRecord(topic = order_info, partition = 0, leaderEpoch = 0, offset = 7, CreateTime = 1659273502239, serialized key size = 0, serialized value size = 18, headers = RecordHeaders(headers = [], isReadOnly = false), key = [B@2add8ff2, value = [B@2a633689).</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.deserializer.KafkaDeserializationSchemaWrapper.deserialize(KafkaDeserializationSchemaWrapper.java:57) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.KafkaRecordEmitter.emitRecord(KafkaRecordEmitter.java:53) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ... 14 more</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Caused by: java.io.IOException: Failed to deserialize CSV row &#x27;&#x27;.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.formats.csv.CsvRowDataDeserializationSchema.deserialize(CsvRowDataDeserializationSchema.java:162) ~[flink-csv-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.formats.csv.CsvRowDataDeserializationSchema.deserialize(CsvRowDataDeserializationSchema.java:47) ~[flink-csv-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.api.common.serialization.DeserializationSchema.deserialize(DeserializationSchema.java:82) ~[flink-core-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.connectors.kafka.table.DynamicKafkaDeserializationSchema.deserialize(DynamicKafkaDeserializationSchema.java:119) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.deserializer.KafkaDeserializationSchemaWrapper.deserialize(KafkaDeserializationSchemaWrapper.java:54) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.KafkaRecordEmitter.emitRecord(KafkaRecordEmitter.java:53) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ... 14 more</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Caused by: org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> at [Source: UNKNOWN; line: -1, column: -1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59) ~[flink-shaded-jackson-2.12.4-15.0.jar:2.12.4-15.0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1601) ~[flink-shaded-jackson-2.12.4-15.0.jar:2.12.4-15.0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectReader._initForReading(ObjectReader.java:358) ~[flink-shaded-jackson-2.12.4-15.0.jar:2.12.4-15.0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectReader._bindAndClose(ObjectReader.java:2023) ~[flink-shaded-jackson-2.12.4-15.0.jar:2.12.4-15.0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:1528) ~[flink-shaded-jackson-2.12.4-15.0.jar:2.12.4-15.0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.formats.csv.CsvRowDataDeserializationSchema.deserialize(CsvRowDataDeserializationSchema.java:155) ~[flink-csv-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.formats.csv.CsvRowDataDeserializationSchema.deserialize(CsvRowDataDeserializationSchema.java:47) ~[flink-csv-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.api.common.serialization.DeserializationSchema.deserialize(DeserializationSchema.java:82) ~[flink-core-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.streaming.connectors.kafka.table.DynamicKafkaDeserializationSchema.deserialize(DynamicKafkaDeserializationSchema.java:119) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.deserializer.KafkaDeserializationSchemaWrapper.deserialize(KafkaDeserializationSchemaWrapper.java:54) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    at org.apache.flink.connector.kafka.source.reader.KafkaRecordEmitter.emitRecord(KafkaRecordEmitter.java:53) ~[flink-connector-kafka-1.15.1.jar:1.15.1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ... 14 more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一些特殊语法">一些特殊语法<a class="hash-link" href="#一些特殊语法" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="列转行">列转行<a class="hash-link" href="#列转行" title="标题的直接链接">​</a></h3><p>也就是将数组展开，一行变多行，使用到 <code>cross join unnest()</code> 语句。</p><p>读取 hive 表数据，然后写入 hive 表。</p><p>source，<code>source_table</code>表信息如下</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.source_table</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col1</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col2</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> array</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">string</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;数组类型的字段&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/source_table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659261419&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>source_table</code>表数据如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="237" height="62" class="img_ev3q"></p><p><code>sink_table</code>表信息如下</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">test.sink_table</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col1</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">col2</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token plain"> FORMAT SERDE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STORED </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> INPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.mapred.TextInputFormat&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OUTPUTFORMAT </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOCATION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hdfs://hadoopCluster/user/hive/warehouse/test.db/sink_table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TBLPROPERTIES </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;transient_lastDdlTime&#x27;</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;1659261915&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>sink_table</code>表数据如下</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="198" height="118" class="img_ev3q"></p><p>下面将使用两种方言演示如何将数组中的数据展开</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用flink方言">使用flink方言<a class="hash-link" href="#使用flink方言" title="标题的直接链接">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> overwrite test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sink_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> col1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">col</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">source_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">cross</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">join</span><span class="token plain"> unnest</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> a </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用hive方言-1">使用hive方言<a class="hash-link" href="#使用hive方言-1" title="标题的直接链接">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.local-time-zone&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;GMT+08:00&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 在需要读取hive或者是写入hive表时，必须创建hive catalog。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">-- 创建catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">create</span><span class="token plain"> catalog hive </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hadoop-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive-conf-dir&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D:\IDEAWorkspace\work\baishan\log\data-max\src\main\resources&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> catalog hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">load</span><span class="token plain"> module hive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;table.sql-dialect&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hive&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">insert</span><span class="token plain"> overwrite </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sink_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> col1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">col</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">source_table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">lateral </span><span class="token keyword" style="color:rgb(0, 0, 255)">view</span><span class="token plain"> explode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">col2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> a </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> col</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="写在最后">写在最后<a class="hash-link" href="#写在最后" title="标题的直接链接">​</a></h2><p>若大家有优秀的使用案例的话，也可向社区反馈，以丰富更多的案例。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/i18n/zh-CN/docusaurus-plugin-content-docs/current/flinksql/5-example.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-CN/docs/flinksql/4-data-type"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">数据类型</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-CN/docs/flinksql/syntax/1-introduce"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">简介</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#介绍" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#编写顺序" class="table-of-contents__link toc-highlight">编写顺序</a></li><li><a href="#写在前面" class="table-of-contents__link toc-highlight">写在前面</a></li><li><a href="#kafka-source" class="table-of-contents__link toc-highlight">kafka source</a></li><li><a href="#kafka---kafka" class="table-of-contents__link toc-highlight">kafka -&gt; kafka</a></li><li><a href="#kafka---hive" class="table-of-contents__link toc-highlight">kafka -&gt; hive</a><ul><li><a href="#写入无分区表" class="table-of-contents__link toc-highlight">写入无分区表</a></li><li><a href="#写入分区表" class="table-of-contents__link toc-highlight">写入分区表</a></li></ul></li><li><a href="#hive---hive" class="table-of-contents__link toc-highlight">hive -&gt; hive</a><ul><li><a href="#使用-flink-方言" class="table-of-contents__link toc-highlight">使用 flink 方言</a></li><li><a href="#使用hive方言" class="table-of-contents__link toc-highlight">使用hive方言</a></li></ul></li><li><a href="#lookup-join" class="table-of-contents__link toc-highlight">lookup join</a></li><li><a href="#temporal-join时态连接" class="table-of-contents__link toc-highlight">temporal join(时态连接)</a></li><li><a href="#一些特殊语法" class="table-of-contents__link toc-highlight">一些特殊语法</a><ul><li><a href="#列转行" class="table-of-contents__link toc-highlight">列转行</a></li></ul></li><li><a href="#写在最后" class="table-of-contents__link toc-highlight">写在最后</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                  <div class="footer-left-box">
                    <div class="flex align-center footer-system">
                      <span class="system-title">About StreamPark</span>
                    </div>
                    <p>Make stream processing easier! easy-to-use streaming application development framework and operation platform</p>
                  </div>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Resource</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/intro">文档</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">版本<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/incubator-streampark" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-streampark/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Follow</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box">
                    <div class="d-flex align-items-center" style="margin-bottom: 30px;padding-top: 11px">
                      <div class="subscribe-input flex-fill">
                        <input class="form-control" id="email_address" maxlength="60" name="email_address" placeholder="Subscribe with us">
                      </div>
                      <div class="subscribe-submit-inner">
                        <a class="btn btn-white m-0" type="submit" href="mailto:dev-subscribe@streampark.apache.org">
                          <span><i class="fa fa-paper-plane text-white"></i></span>
                        </a>
                      </div>
                    </div>
                    <ul class="icon-bottom">
                        <li>
                          <a href="javascript:void(0)">
                            <i class="fa fa-wechat"></i>
                            <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                          </a>
                        </li>
                        <li><a href="javascript:void(0)"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="javascript:void(0)"><i class="fa fa-slack"></i></a></li>
                        <li><a href="javascript:void(0)"><i class="fa fa-facebook"></i></a></li>
                    </ul>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
            <div style="text-align: left;margin-top:30px">
                <div class="d-flex align-items-center">
                    <div>
                      <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
                        <img src="/image/apache-incubator.svg" alt="Apache Incubator logo" class="footer__logo">
                      </a>
                    </div>
                    <div>
                      <p style="font-family: Avenir-Medium;font-size: 14px;color: #999;line-height: 25px;">
                      Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
                      </p>
                  </div>
                </div>
                
                <div style="border-top: 1px solid #525252;min-height: 60px;line-height: 25px;text-align: left;font-family: Avenir-Medium;font-size: 14px;color: #999;display: flex;align-items: center;">
                  <span>
                      Copyright © 2022 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
                  </span>
                </div>
            </div></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.bc03e73f.js"></script>
<script src="/zh-CN/assets/js/main.e2f9a7ff.js"></script>
</body>
</html>